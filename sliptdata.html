<html><title>Chuyển tọa độ cột từ excel thành array object trong javascript</title><style>*{margin:0;padding:0}body,html{overflowX:hidden;background-image:linear-gradient(to right,#43e97b 0,#38f9d7 100%);font-family:math}#container{width:90vw}#list_data{width:100%;height:90vh;resize:none;border:0;padding:20px;margin:10px 0 10px 0}#list_data:focus{outline:0}button{height:38px;padding:5px;margin:5px;border:0;border-radius:4px;box-sizing:border-box;color:#fff;background-color:#1eaedb;border-color:#1eaedb;font-size:1.2rem}#btndownload{display:none}a{text-decoration:none;color:#fff}#copy{display:none}#tools{display:inline-flex;align-items:center;background:#fff;width:100%}#inner{margin:auto;display:inline-flex}</style><body><center><div id="container"><textarea id="list_data"></textarea><div id="tools"><div id="inner"><button type="button" id="btndownload"><a id="save">Lưu thành tệp tin</a></button> <button onclick="sliptall()">Chuyển đổi</button> <button onclick="Clear()">Làm mới</button> <button id="copy" onclick="Copy()">Sao chép</button></div></div></div></center><script>function sliptdata(t){t+="";var e=t.split("	"),n=e[0],a=e[1]?t.substr(t.indexOf("	")+1):"",l=a.split(", "),o=l[0],r=l[1]?t.substr(t.indexOf(", ")+2):"";if(o.length===a.length&&(l=a.split(" "),o=l[0],r=l[1]?a.substr(a.indexOf(" ")+2):""),o.length===a.length){var i=l+"";l=i.split("	"),o=l[0],r=l[1]?i.substr(i.indexOf("	")+1):""}array_cot.push(n),array_x.push(o),array_y.push(r)}function sliptall(){var t=document.getElementById("list_data").value.split("\n").filter(function(t){return null!=t&&void 0!=t&&0!=t.length});for(i=0;i<t.length;i++)sliptdata(t[i]);var e="[\n",n="";for(i=0;i<array_cot.length;i++)n+=" {\n 	cot: '"+array_cot[i]+"',\n 	x: '"+array_x[i]+"',\n 	y: '"+array_y[i]+"',\n },\n";e=e+n+"];",document.getElementById("list_data").value=e,document.getElementById("btndownload").style.display="block",document.getElementById("copy").style.display="block";var a=document.getElementById("save");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),a.setAttribute("download","data.txt")}function Copy(){document.querySelector("textarea").select(),document.execCommand("copy"),alert("Đã copy")}function Clear(){document.querySelector("textarea").value="",document.getElementById("btndownload").style.display="none",document.getElementById("copy").style.display="none"}var array_cot=[],array_x=[],array_y=[];</script></body></html>